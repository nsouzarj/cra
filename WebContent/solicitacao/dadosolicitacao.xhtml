<?xml version='1.0' encoding='ISO-8859-1' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:p="http://primefaces.org/ui"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:pe="http://primefaces.org/ui/extensions"
	xmlns:b="http://bootsfaces.net/ui">

<h:head>
	<title>Detalhes da Solicitação</title>
	<meta http-equiv="Content-Type;CONTROl=CACHE"
		content="text/html;NO-CACHE;enconding=ISO-8859-1;5;Refresh;URL=dadosolicitacao.jsf" />
	<link rel="icon" type="image/x-icon"
		href="#{request.contextPath}/imagens/favicon.ico" />
	<link type="text/css" rel="stylesheet"
		href="#{request.contextPath}/themes/redmond/skin.css" />

	<style type="text/css">
.ui-widget {
	font-size: 80%;
}

.ui-tooltip {
	padding: 10px 20px;
	color: #2E6E9E;
	border-radius: 10px;
	font: bold 14px "Helvetica Neue", Sans-Serif;
	box-shadow: 0 0 7px #87B6D9;
}

.themeMenu {
	font: bold;
	height: 200px;
	width: 100px;
}
</style>

	<script type="text/javascript">
		
	</script>

</h:head>
<f:view encoding="ISO-8859-1" contentType="text/html">

	<h:form id="fm1">
		<p:growl id="msg2" life="5000" showDetail="false" sticky="false"
			escape="true" />

		<b:commandButton value="Sair da Tela" id="bt1"
			onclick="window.close();" look="primary"
			action="/solicitacao/soliusuario.jsf" immediate="false"
			title="Click aqui para sair da tela"
			icon="ui-icon-arrowreturnthick-1-w">
			<f:setPropertyActionListener target="#{solicitacao.mostrajanela}"
				value="false" />
			<f:setPropertyActionListener
				target="#{solicitacao.buscatodasoclitacoes}" value="true" />
			<f:setPropertyActionListener target="#{solicitacao.bnumero}"
				value="0" />
			<p:ajax process="@this" />
		</b:commandButton>
		<p:commandButton value="Concluir" id="concluir" ajax="true"
			process="@this" onclick="cd.show();"
			rendered="#{solicitacao.unicasolicitacao.statusSolicitacao.idstatus==4}"
			icon="ui-icon-check">
		</p:commandButton>

		<p:tooltip for="bt1" hideEffect="slide"
			value="Clique para voltar a tela inicial de busca." />
		<p:tooltip for="bt2" hideEffect="slide"
			value="Clique para para reativar a solicitação." />
		<b:panel title="Dados da Solicitação" look="primary" id="pnl7">

			<h:outputText value="Dados da Solicitação"
				style="font-size:16pt;font-family:arial" />
			<p/>
			<h:outputText value="Usuário Logado: #{usuarios.loginacesso}"
				style="font-size:14pt;font-family:arial" />
			<p/>
			<p/>

			<h:panelGroup>
				<p:panelGrid columns="2">
					<h:outputText value="ID Solicitacão:" />
					<h:outputText value="#{solicitacao.unicasolicitacao.idsolicitacao}" />
					<h:outputText value="Data do Prazo da Solicitação:" />
					<h:outputText value="#{solicitacao.unicasolicitacao.dataprazo}"
						style="font-color:#FF0000;bgcolor:#FF0000">
						<f:convertDateTime pattern="dd/MM/yyyy" />
					</h:outputText>

					<h:outputText value="Solicitante:" />
					<h:outputText
						value="#{solicitacao.unicasolicitacao.usuario.nomecompleto}" />
					<h:outputText value="Processo:" />
					<h:outputText
						value="#{solicitacao.unicasolicitacao.processo.numeroprocesso}" />
					<h:outputText value="Autor:" />
					<h:outputText
						value="#{solicitacao.unicasolicitacao.processo.parte}" />
					<h:outputText value="Réu:" />
					<h:outputText
						value="#{solicitacao.unicasolicitacao.processo.adverso}" />
					<h:outputText value="Assunto:" />
					<h:outputText
						value="#{solicitacao.unicasolicitacao.processo.assunto}" />
					<h:outputText value="Comarca:" />
					<h:outputText value="#{solicitacao.unicasolicitacao.comarca.nome}" />
					<h:outputText value="Cartório:" />
					<h:outputText
						value="#{solicitacao.unicasolicitacao.processo.numorgao} - #{solicitacao.unicasolicitacao.processo.orgao.descricao}" />
					<h:outputText value="Tipo de Solicitação:" />
					<h:outputText
						value="#{solicitacao.unicasolicitacao.renumeracao.tipoSolicitacaoCorrespondente.tipoSolicitacao.especie} - #{solicitacao.unicasolicitacao.renumeracao.tipoSolicitacaoCorrespondente.tipoSolicitacao.tipo}" />
					<h:outputText value="Envio de"
						rendered="#{solicitacao.unicasolicitacao.renumeracao.tipoSolicitacaoCorrespondente.tipoSolicitacao.especie=='AUDIENCIA'}" />
					<h:outputText
						value="#{solicitacao.unicasolicitacao.enviosolicitacao.tipoenvio}"
						rendered="#{solicitacao.unicasolicitacao.renumeracao.tipoSolicitacaoCorrespondente.tipoSolicitacao.especie=='AUDIENCIA'}" />


					<h:outputText value="Hora da Audiencia"
						rendered="#{solicitacao.unicasolicitacao.renumeracao.tipoSolicitacaoCorrespondente.tipoSolicitacao.especie=='AUDIENCIA'}" />
					<h:outputText value="#{solicitacao.unicasolicitacao.horaudiencia}"
						rendered="#{solicitacao.unicasolicitacao.renumeracao.tipoSolicitacaoCorrespondente.tipoSolicitacao.especie=='AUDIENCIA'}" />
					<h:outputText value="Status Atual da Solicitação" />
					<h:outputText
						value="#{solicitacao.unicasolicitacao.statusSolicitacao.status}" />

					<h:outputText value="Proposta de Acordo"
						rendered="#{solicitacao.unicasolicitacao.propostaacordo==true}" />
					<h:outputText value="SIM"
						rendered="#{solicitacao.unicasolicitacao.propostaacordo==true}" />
					<h:outputText value="Valor da Alçada(R$)"
						rendered="#{solicitacao.unicasolicitacao.propostaacordo==true}" />
					<h:outputText value="#{solicitacao.unicasolicitacao.valordaalcada}"
						rendered="#{solicitacao.unicasolicitacao.propostaacordo==true}">
						<f:convertNumber type="currency" currencySymbol="" />
					</h:outputText>

					<p:commandButton value="Clique aqui para reativar"
						action="#{solicitacao.ReativaSolictacao()}" id="bt2" ajax="false"
						rendered="#{solicitacao.unicasolicitacao.statusSolicitacao.idstatus==6 and solicitacao.usuario.tipo==3}">
						<p:ajax immediate="false" update="msg2" />
					</p:commandButton>

					<h:outputText value="Selecione o status da solicitação:"
						rendered="#{solicitacao.unicasolicitacao.statusSolicitacao.idstatus==1}" />
					<p:selectOneMenu id="selec" value="#{solicitacao.statusexterno}"
						rendered="#{solicitacao.unicasolicitacao.statusSolicitacao.idstatus==1}"
						immediate="true">
						<f:selectItem id="item1"
							itemLabel="Click aqui para aceita a solicitação" itemValue="0" />
						<f:selectItem id="item2" itemLabel="CONFIRMAR"
							itemValue="CONFIRMADO" />
						<f:selectItem id="item3" itemLabel="REJEITAR"
							itemValue="REJEITADO" />
						<f:ajax execute="@this" render="@all" />
					</p:selectOneMenu>
					<h:outputText value="Motivo da rejeição" id="rej1"
						rendered="#{solicitacao.statusexterno=='REJEITADO'}">
					</h:outputText>
					<p:inputTextarea value="#{solicitacao.textodarejeicao}" id="rej2"
						rendered="#{solicitacao.statusexterno=='REJEITADO'}"
						autoResize="true"
						style="display:block;border-width: 1px;border-style: solid;border-color:#A6C9E2;padding:1px;margin-top:1px;width:360px;height:100px;overflow:scroll">
						<f:ajax render="@this" />
					</p:inputTextarea>
					<p:commandButton id="tesed" action="#{solicitacao.MudaStatus}"
						ajax="true" process="@this" update="@all" immediate="false"
						value="Salvar"
						rendered="#{solicitacao.unicasolicitacao.statusSolicitacao.idstatus==1}"
						icon="ui-icon-disk" />
				</p:panelGrid>
			</h:panelGroup>
		</b:panel>
		<b:panel title="Instruções da solicitação e Observações" id="pn4"
			look="primary">
			<h:panelGroup>
				<h:panelGrid columns="3">
					<p:inputTextarea value="#{solicitacao.unicasolicitacao.instrucoes}" label="Instruções da Solicitação"
						title="Instruções da Solicitação" disabled="false"
						readonly="true" autoResize="true"
						style="display:block;border-width: 1px;border-style:solid;font-color:red; border-color:#A6C9E2;padding:1px;margin-top:1px;width:360px;height:auto;overflow:scroll">
					</p:inputTextarea>
					<p:inputTextarea widgetVar="tests" id="obs1" label="Observação do Colaborador Externo"
						value="#{solicitacao.observacaofinal}"
						required="#{solicitacao.unicasolicitacao.statusSolicitacao.idstatus==4}"
						requiredMessage="Favor colocar o texto de finalização antes de concluir"
						immediate="false" autoResize="true"
						style="display:block;border-width: 1px;border-style: solid;border-color:#A6C9E2;padding:1px;margin-top:1px;width:360px;height:100px;overflow:scroll"
						title="Observações da Solicitação">
						<p:ajax process="@this" />
					</p:inputTextarea>
					<p:inputTextarea label="Motivo da Rejeição ou Cancelamento Definitivo"
						value="#{solicitacao.unicasolicitacao.complemento}"
						rendered="#{solicitacao.unicasolicitacao.statusSolicitacao.idstatus==6 or solicitacao.unicasolicitacao.statusSolicitacao.idstatus==10}"
						immediate="false" autoResize="true" readonly="true"
						style="display:block;border-width: 1px;border-style: solid;border-color:#A6C9E2;padding:1px;margin-top:1px;width:360px;height:100px;overflow:scroll"
						title="Motivo da reprovação da solicitação pelo solicitante.">
					</p:inputTextarea>
				</h:panelGrid>
			</h:panelGroup>
		</b:panel>
		<b:panel title="Arquivos da solicitação" look="primary">
			<p:panelGrid columns="2">
				<h:panelGroup>
					<!-- rendered="#{solicitacao.unicasolicitacao.statusSolicitacao.idstatus==4 or solicitacao.unicasolicitacao.statusSolicitacao.idstatus==5 or solicitacao.unicasolicitacao.statusSolicitacao.idstatus==7 or solicitacao.unicasolicitacao.statusSolicitacao.idstatus==6}" -->

					<h:panelGrid columns="2" style="border: 0px solid #FCFDFD">
						<p:dataTable value="#{solicitacao.listasaida}" var="lista1"
							id="lista1" emptyMessage="Nâo existe arquivos">
							<p:column>
								<f:facet name="header">
									<h:outputText value="Nome do Arquivo Recebido" />
								</f:facet>
								<p:commandLink immediate="true" ajax="false"
									value="#{lista1.solicitacaoPossuiArquivo.solicitacaoAnexo.nomearquivo}"
									action="#{solicitacao.BaixarArquivo(lista1.solicitacaoPossuiArquivo.solicitacaoAnexo.linkarquivo, 'ENVIADO')}">
									<f:setPropertyActionListener
										value="#{lista1.solicitacaoPossuiArquivo.solicitacaoAnexo.nomearquivo}"
										target="#{solicitacao.arquivoparabaixar}" />
										
								</p:commandLink>
							</p:column>
							<p:column>
								<f:facet name="header">
									<h:outputText value="Data" />
								</f:facet>
								<h:outputText
									value="#{lista1.solicitacaoPossuiArquivo.solicitacaoAnexo.datasolicitacao}">
									<f:convertDateTime pattern="dd/MM/yyyyy HH:mm" />
								</h:outputText>
							</p:column>
						</p:dataTable>
					</h:panelGrid>

				</h:panelGroup>
				<h:panelGroup
					rendered="#{solicitacao.unicasolicitacao.statusSolicitacao.idstatus==4 or solicitacao.unicasolicitacao.statusSolicitacao.idstatus==5 or solicitacao.unicasolicitacao.statusSolicitacao.idstatus==7 or solicitacao.unicasolicitacao.statusSolicitacao.idstatus==6}">
					<h:panelGrid columns="2" style="border: 0px solid #FCFDFD">
						<p:dataTable value="#{solicitacao.listaentrada}" var="lista2"
							id="lista2" emptyMessage="Nâo existe arquivos">
							<p:column>
								<f:facet name="header">
									<h:outputText value="Nome do Arquivo Enviado" />
								</f:facet>
								<p:commandLink immediate="false" ajax="false" process="@this"
									update="@this" global="false"
									value="#{lista2.solicitacaoPossuiArquivo.solicitacaoAnexo.nomearquivo}"
									action="#{solicitacao.BaixarArquivo(lista2.solicitacaoPossuiArquivo.solicitacaoAnexo.linkarquivo, 'RECEBIDO')}">
									<f:setPropertyActionListener
										value="#{lista2.solicitacaoPossuiArquivo.solicitacaoAnexo.linkarquivo}"
										target="#{solicitacao.arquivoparabaixar}" />


								</p:commandLink>
							</p:column>
							<p:column>
								<f:facet name="header">
									<h:outputText value="Data" />
								</f:facet>
								<h:outputText
									value="#{lista2.solicitacaoPossuiArquivo.solicitacaoAnexo.datasolicitacao}">
									<f:convertDateTime pattern="dd/MM/yyyyy HH:mm" />
								</h:outputText>
							</p:column>
							<p:column
								rendered="#{solicitacao.unicasolicitacao.statusSolicitacao.idstatus==4 or solicitacao.unicasolicitacao.statusSolicitacao.idstatus==6  }">
								<f:facet name="header">
									<h:outputText value="Excluir" />
								</f:facet>

								<p:commandButton value="Excluir" icon="ui-icon-trash"
									action="#{solicitacao.ExcluirArquivoAnexo(lista2.solicitacaoPossuiArquivo.solicitacaoAnexo.idarquivoanexo)}"
									ajax="false" process="lista2">
									<f:setPropertyActionListener
										target="#{solicitacao.idarquivoanexo}"
										value="#{lista2.solicitacaoPossuiArquivo.solicitacaoAnexo.idarquivoanexo}" />
								</p:commandButton>
							</p:column>
						</p:dataTable>
					</h:panelGrid>
					<p />
					<h:outputText value="Arquivos Enviados"
						rendered="#{solicitacao.unicasolicitacao.statusSolicitacao.idstatus==4}" />
					<p:fileUpload disabled="false" immediate="false" id="arq1"
						multiple="true"
						invalidSizeMessage="Limite de tamanho excedido de 25 megas para envio."
						dragDropSupport="true"
						fileUploadListener="#{solicitacao.AnexarArquivos}"
						label="Selecionar" cancelLabel="Cancelar" style="font-size:10px"
						mode="advanced" uploadLabel="Salvar Arquivo." update="lista2 msg2"
						rendered="#{solicitacao.unicasolicitacao.statusSolicitacao.idstatus==4  and solicitacao.usuario.tipo==3}" />
				</h:panelGroup>
			</p:panelGrid>
			<h:panelGroup rendered="false">
				<!-- 	rendered="#{solicitacao.unicasolicitacao.statusSolicitacao.idstatus==4 and solicitacao.unicasolicitacao.renumeracao.tipoSolicitacaoCorrespondente.tipoSolicitacao.especie=='AUDIENCIA'}">  -->
				<h:outputText value="Audiencia foi convolada?" />
				<p:selectOneRadio id="teste4" value="#{solicitacao.foiconvolada}">
					<f:selectItem itemLabel="Não" itemValue="#{false}" />
					<f:selectItem itemLabel="Sim" itemValue="#{true}" />
				</p:selectOneRadio>
			</h:panelGroup>

			<b:commandButton look="success"
				title="Clique aqui para preencher o formulário de audiência"
				value="FORMULÁRIO DE AUDIÊNCIA"
				action="#{solicitacao.TrazVazioFomulario}" immediate="false"
				ajax="true" process="@this" id="concluio2"
				rendered="#{solicitacao.unicasolicitacao.statusSolicitacao.idstatus==4 and solicitacao.unicasolicitacao.renumeracao.tipoSolicitacaoCorrespondente.tipoSolicitacao.especie=='AUDIENCIA'}" />
			<h:outputText value="#{'  '}" />



			<p:confirmDialog
				message="Se concluir não poderá inserir mais os arquivos."
				appendToBody="concluir" modal="true" id="dlgh1" rendered="true"
				header="Concluir a Solicitação?" severity="alert" widgetVar="cd">
				<p:panel>
					<p:commandButton value="Sim" immediate="false"
						action="#{solicitacao.MudaStatusGeral}" ajax="false"
						onclick="cd.hide()" icon="ui-icon-check">
						<p:ajax update="avisa1" process="@this"
							listener="#{solicitacao.MudaStatusGeral}" immediate="false" />
					</p:commandButton>
					<p:commandButton value="Não" onclick="cd.hide();" ajax="true"
						type="submit" icon="ui-icon-cancel" />
				</p:panel>
			</p:confirmDialog>


		</b:panel>
		<p:ajaxStatus id="avisa1"
			style="width:64px;height:64px;position:fixed;right:680px;bottom:300px">
			<f:facet name="start">
				<p:graphicImage value="/imagens/loading.gif" />
			</f:facet>
			<f:facet name="complete">
				<h:outputText value="" />
			</f:facet>
		</p:ajaxStatus>
	</h:form>

</f:view>

</html>
